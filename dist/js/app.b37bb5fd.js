(function(){"use strict";var e={2487:function(e,a,t){var l=t(5130),o=t(6768);function s(e,a,t,l,s,i){const n=(0,o.g2)("EquipmentHeader"),d=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)(o.FK,null,["/"!==e.$route.path?((0,o.uX)(),(0,o.Wv)(n,{key:0})):(0,o.Q3)("",!0),(0,o.bF)(d)],64)}const i={class:"tables-container"};function n(e,a,t,l,s,n){const d=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",i,[l.isAdmin||l.isEmployee||l.isEquipmentResponsible?((0,o.uX)(),(0,o.Wv)(d,{key:0,to:"/main",exact:"","active-class":"active-link",class:"link"},{default:(0,o.k6)((()=>[(0,o.eW)("Оборудование")])),_:1})):(0,o.Q3)("",!0),l.isAdmin?((0,o.uX)(),(0,o.Wv)(d,{key:1,to:"/division",exact:"","active-class":"active-link",class:"link"},{default:(0,o.k6)((()=>[(0,o.eW)("Структурные подразделения")])),_:1})):(0,o.Q3)("",!0),l.isAdmin?((0,o.uX)(),(0,o.Wv)(d,{key:2,to:"/responsibles",exact:"","active-class":"active-link",class:"link"},{default:(0,o.k6)((()=>[(0,o.eW)("Мат. ответственные")])),_:1})):(0,o.Q3)("",!0),l.isAdmin?((0,o.uX)(),(0,o.Wv)(d,{key:3,to:"/users",exact:"","active-class":"active-link",class:"link"},{default:(0,o.k6)((()=>[(0,o.eW)("Пользователи")])),_:1})):(0,o.Q3)("",!0),l.isAdmin?((0,o.uX)(),(0,o.Wv)(d,{key:4,to:"/status",exact:"","active-class":"active-link",class:"link"},{default:(0,o.k6)((()=>[(0,o.eW)("Статус оборудования")])),_:1})):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:a[0]||(a[0]=(...e)=>l.logout&&l.logout(...e)),class:"logout"},"Выход")])}const d=()=>"1"===localStorage.getItem("role_id"),u=()=>"2"===localStorage.getItem("role_id"),r=()=>"3"===localStorage.getItem("role_id");var c={name:"EquipmentHeader",setup(){const e=()=>{localStorage.clear(),window.location.reload()},a=(0,o.EW)((()=>d())),t=(0,o.EW)((()=>u())),l=(0,o.EW)((()=>r()));return{logout:e,isAdmin:a,isEmployee:t,isEquipmentResponsible:l}}},m=t(1241);const p=(0,m.A)(c,[["render",n],["__scopeId","data-v-99710a10"]]);var b=p,v={name:"App",components:{EquipmentHeader:b}};const h=(0,m.A)(v,[["render",s]]);var _=h,w=t(1387);const g={class:"main-container"},f={class:"search"},y={class:"button-container"};function k(e,a,t,s,i,n){const d=(0,o.g2)("VueTableLite"),u=(0,o.g2)("MainModalPage");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",g,[(0,o.Lk)("div",f,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.search=e),type:"text",class:"search__input",placeholder:"Поиск",onKeydown:a[1]||(a[1]=(0,l.jR)((()=>s.doSearch(0,10,s.table.sortable.order,s.table.sortable.sort)),["enter"]))},null,544),[[l.Jo,s.search]]),(0,o.Lk)("input",{type:"button",value:"Поиск",class:"search__btn",onClick:a[2]||(a[2]=()=>s.doSearch(0,10,s.table.sortable.order,s.table.sortable.sort))})]),(0,o.Lk)("div",y,[s.isAdmin||s.isEmployee?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"submit",class:"add_row",title:"Добавить оборудование",onClick:a[3]||(a[3]=(...e)=>s.showModal&&s.showModal(...e))})):(0,o.Q3)("",!0),s.isAdmin||s.isEmployee?((0,o.uX)(),(0,o.CE)("button",{key:1,type:"submit",class:"btn_download",title:"Сформировать ведомость",onClick:a[4]||(a[4]=(...e)=>s.downloadDocument&&s.downloadDocument(...e))})):(0,o.Q3)("",!0)]),(0,o.bF)(d,{"is-loading":s.table.isLoading,columns:s.table.columns,rows:s.table.rows,rowClasses:s.table.rowClasses,total:s.table.totalRecordCount,"is-hide-paging":!0,"hide-default-footer":!0,sortable:s.table.sortable,onDoSearch:s.doSearch,onRowClicked:s.rowClicked,class:"table"},null,8,["is-loading","columns","rows","rowClasses","total","sortable","onDoSearch","onRowClicked"])]),s.isVisible?((0,o.uX)(),(0,o.Wv)(u,{key:0,showModal:s.isVisible,onCloseModal:s.closeModal,isNewEquipment:s.isNewEquipment,oldData:s.oldData},null,8,["showModal","onCloseModal","isNewEquipment","oldData"])):(0,o.Q3)("",!0)],64)}t(4114);var q=t(7764),C=t(144),L=t(1114),N=t(8355);const E=()=>N.A.create({baseURL:"http://45.140.19.41:3000",headers:{user_id:localStorage.getItem("user_id"),role_id:localStorage.getItem("role_id")}});var R=E;class D{}(0,L.A)(D,"registration",((e,a,t,l,o,s,i)=>new Promise(((n,d)=>{R().post("/registration",{role_id:e,division_id:a,login:t,password:l,first_name:o,last_name:s,middle_name:i}).then((e=>n(e.data))).catch((e=>d(e)))})))),(0,L.A)(D,"login",((e,a)=>new Promise(((t,l)=>{R().post("/login",{login:e,password:a}).then((e=>t(e.data))).catch((e=>l(e)))})))),(0,L.A)(D,"getEquipmentList",((e,a,t)=>new Promise(((l,o)=>{R().get("/equipments",{params:{order:e,sort:a,search:t}}).then((e=>l(e.data))).catch((e=>o(e)))})))),(0,L.A)(D,"getEquipmentStatusList",(()=>new Promise(((e,a)=>{R().get("/status").then((a=>e(a.data))).catch((e=>a(e)))})))),(0,L.A)(D,"getEquipmentResponsibleList",(()=>new Promise(((e,a)=>{R().get("/responsible").then((a=>e(a.data))).catch((e=>a(e)))})))),(0,L.A)(D,"getDivisionList",(()=>new Promise(((e,a)=>{R().get("/division").then((a=>e(a.data))).catch((e=>a(e)))})))),(0,L.A)(D,"getUserList",(()=>new Promise(((e,a)=>{R().get("/user").then((a=>e(a.data))).catch((e=>a(e)))})))),(0,L.A)(D,"getRoleList",(()=>new Promise(((e,a)=>{R().get("/role").then((a=>e(a.data))).catch((e=>a(e)))})))),(0,L.A)(D,"addEquipment",((e,a,t,l,o,s,i,n,d)=>new Promise(((u,r)=>{R().post("/equipments",{equipment_status_id:e,user_id:a,responsible_id:t,equipment_name:l,inventory_number:o,balance_cost:s,quantity:i,date_registration:n,date_de_registration:d}).then((e=>u(e.data))).catch((e=>r(e)))})))),(0,L.A)(D,"addEquipmentStatus",(e=>new Promise(((a,t)=>{R().post("/status",{equipment_status_name:e}).then((e=>a(e.data))).catch((e=>t(e)))})))),(0,L.A)(D,"addEquipmentResponsible",((e,a,t,l,o)=>new Promise(((s,i)=>{R().post("/responsible",{division_id:e,equipment_responsible_f_name:a,equipment_responsible_s_name:t,equipment_responsible_l_name:l,equipment_responsible_position:o}).then((e=>s(e.data))).catch((e=>i(e)))})))),(0,L.A)(D,"addDivision",(e=>new Promise(((a,t)=>{R().post("/division",{division_name:e}).then((e=>a(e.data))).catch((e=>t(e)))})))),(0,L.A)(D,"updateEquipment",((e,a,t,l,o,s,i,n,d)=>new Promise(((u,r)=>{R().put("/equipments",{equipment_id:e,equipment_status_id:a,responsible_id:t,equipment_name:l,inventory_number:o,balance_cost:s,quantity:i,date_registration:n,date_de_registration:d}).then((e=>u(e.data))).catch((e=>r(e)))})))),(0,L.A)(D,"updateEquipmentStatus",((e,a)=>new Promise(((t,l)=>{R().put("/status",{equipment_status_id:e,equipment_status_name:a}).then((e=>t(e.data))).catch((e=>l(e)))})))),(0,L.A)(D,"updateUser",((e,a,t,l,o,s,i)=>new Promise(((n,d)=>{console.log("afa",{user_id:e,role_id:a,division_id:t,login:l,first_name:o,last_name:s,middle_name:i}),R().put("/user",{user_id:e,role_id:a,division_id:t,login:l,first_name:o,last_name:s,middle_name:i}).then((e=>n(e.data))).catch((e=>d(e)))})))),(0,L.A)(D,"updateDivision",((e,a)=>new Promise(((t,l)=>{R().put("/division",{division_id:e,division_name:a}).then((e=>t(e.data))).catch((e=>l(e)))})))),(0,L.A)(D,"downloadFile",(e=>new Promise(((a,t)=>{R().get("/download",{params:{search:e}}).then((()=>{const a="http://45.140.19.41:3000",t=document.createElement("a");t.setAttribute("href",`${a}/download?search=${e}`),t.setAttribute("download","test.docx"),document.body.appendChild(t),t.click(),document.body.removeChild(t)})).catch((e=>t(e)))}))));var S=D,M=t(4232);const K={key:0,class:"modal"},X={class:"modal-content"},V={key:0},A={key:1},U={for:"equipment_name"},P={for:"inventory_number"},Q={for:"balance_cost"},I={for:"quantity"},x={for:"date_registration"},F={for:"date_de_registration"},T={value:null,disabled:"",selected:""},W=["value"],J={value:null,disabled:"",selected:""},O=["value"],j={class:"button-block"};function $(e,a,t,s,i,n){return t.showModal?((0,o.uX)(),(0,o.CE)("div",K,[(0,o.Lk)("div",X,[t.isNewEquipment?((0,o.uX)(),(0,o.CE)("h2",V,"Добавить оборудование")):((0,o.uX)(),(0,o.CE)("h2",A,"Изменить оборудование")),(0,o.Lk)("label",U,[(0,o.bo)((0,o.Lk)("input",{id:"equipment_name",type:"text",placeholder:"Введите название оборудования","onUpdate:modelValue":a[0]||(a[0]=e=>s.equipmentName=e),class:"equipment-field"},null,512),[[l.Jo,s.equipmentName]])]),(0,o.Lk)("label",P,[(0,o.bo)((0,o.Lk)("input",{id:"inventory_number",type:"text",placeholder:"Введите инвентарный номер оборудования","onUpdate:modelValue":a[1]||(a[1]=e=>s.inventoryNumber=e),class:"equipment-field"},null,512),[[l.Jo,s.inventoryNumber]])]),(0,o.Lk)("label",Q,[(0,o.bo)((0,o.Lk)("input",{id:"balance_cost",type:"text",placeholder:"Введите стоимость оборудования","onUpdate:modelValue":a[2]||(a[2]=e=>s.balanceCost=e),class:"equipment-field"},null,512),[[l.Jo,s.balanceCost]])]),(0,o.Lk)("label",I,[(0,o.bo)((0,o.Lk)("input",{id:"quantity",type:"text",placeholder:"Введите количество оборудования","onUpdate:modelValue":a[3]||(a[3]=e=>s.quantity=e),class:"equipment-field"},null,512),[[l.Jo,s.quantity]])]),(0,o.Lk)("label",x,[(0,o.bo)((0,o.Lk)("input",{id:"date_registration",type:"date",placeholder:"Дата принятия к учету:","onUpdate:modelValue":a[4]||(a[4]=e=>s.dateRegistration=e),class:"equipment-field"},null,512),[[l.Jo,s.dateRegistration]])]),(0,o.Lk)("label",F,[(0,o.bo)((0,o.Lk)("input",{id:"date_de_registration",type:"date",placeholder:"Дата снятия с учета:","onUpdate:modelValue":a[5]||(a[5]=e=>s.dateDeRegistration=e),class:"equipment-field"},null,512),[[l.Jo,s.dateDeRegistration]])]),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>s.selectedResponsible=e),id:"equipment_responsible_full_name",class:"equipment-field"},[(0,o.Lk)("option",T,(0,M.v_)(s.baseData.equipmentResponsibleFullName),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.responsibleList,((e,a)=>((0,o.uX)(),(0,o.CE)("option",{value:e,key:a},(0,M.v_)(e.equipment_responsible_full_name),9,W)))),128))],512),[[l.u1,s.selectedResponsible]]),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>s.selectedStatus=e),id:"equipment_status_name",class:"equipment-field"},[(0,o.Lk)("option",J,(0,M.v_)(s.baseData.equipmentStatusName),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.statusList,((e,a)=>((0,o.uX)(),(0,o.CE)("option",{value:e,key:a},(0,M.v_)(e.equipment_status_name),9,O)))),128))],512),[[l.u1,s.selectedStatus]]),(0,o.Lk)("div",j,[t.isNewEquipment?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:a[8]||(a[8]=(...e)=>s.addEquipment&&s.addEquipment(...e))},"Добавить")):(0,o.Q3)("",!0),t.isNewEquipment?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:a[9]||(a[9]=(...e)=>s.updateEqipment&&s.updateEqipment(...e))},"Изменить")),(0,o.Lk)("button",{onClick:a[10]||(a[10]=(...e)=>s.closeModal&&s.closeModal(...e))},"Закрыть")])])])):(0,o.Q3)("",!0)}var B={name:"MainModalPage",props:{showModal:{type:Boolean,default:!1},isNewEquipment:{type:Boolean,default:!1},oldData:{type:Object,default:null}},setup(e,{emit:a}){const t={equipmentResponsibleFullName:"ФИО мат. ответственного",equipmentStatusName:"Статус оборудования"},l=(0,C.KR)(""),s=(0,C.KR)(""),i=(0,C.KR)(""),n=(0,C.KR)(""),d=(0,C.KR)(null),u=(0,C.KR)(null),r=(0,C.KR)(null),c=(0,C.KR)(null),m=(0,C.KR)([]),p=(0,C.KR)([]),b=()=>{l.value="",s.value="",i.value="",n.value="",d.value=null,u.value=null,r.value=null,c.value=null,a("closeModal",!1)},v=async()=>{const e={equipmentName:l.value,inventoryNumber:s.value,balance_cost:i.value,quantity:n.value,selectedStatus:d.value,selectedResponsible:u.value,date_registration:r.value,date_de_registration:c.value};await S.addEquipment(e.selectedStatus.equipment_status_id,localStorage.getItem("user_id"),e.selectedResponsible.responsible_id,e.equipmentName,e.inventoryNumber,e.balance_cost,e.quantity,e.date_registration,e.date_de_registration),b(),window.location.reload()},h=async()=>{const a={equipmentName:l.value,inventoryNumber:s.value,balance_cost:i.value,quantity:n.value,selectedStatus:d.value,selectedResponsible:u.value,date_registration:r.value,date_de_registration:c.value?c.value:null};try{console.log(a.selectedResponsible),await S.updateEquipment(e.oldData.equipment_id,a.selectedStatus.equipment_status_id,a.selectedResponsible.responsible_id,a.equipmentName,a.inventoryNumber,a.balance_cost,a.quantity,a.date_registration,a.date_de_registration)}catch(t){console.log(t)}finally{b(),window.location.reload()}};return(0,o.sV)((async()=>{await S.getEquipmentStatusList().then((e=>{d.value=null,e.forEach((e=>{m.value.push(e)}))})),await S.getEquipmentResponsibleList().then((e=>{u.value=null,e.forEach((e=>{p.value.push(e)}))})),e.oldData&&(console.log(e.oldData),l.value=e.oldData.equipment_name,s.value=e.oldData.inventory_number,i.value=e.oldData.balance_cost,n.value=e.oldData.quantity,r.value=e.oldData.date_registration,c.value=e.oldData.date_de_registration,u.value={responsible_id:e.oldData.responsible_id,equipment_responsible_full_name:e.oldData.responsible_full_name,division_id:e.oldData.division_id,division_name:e.oldData.division_name},d.value={equipment_status_id:e.oldData.equipment_status_id,equipment_status_name:e.oldData.equipment_status_name})})),{equipmentName:l,inventoryNumber:s,selectedStatus:d,selectedResponsible:u,inventoryNumber:s,baseData:t,balanceCost:i,quantity:n,dateRegistration:r,dateDeRegistration:c,closeModal:b,addEquipment:v,updateEqipment:h,statusList:m,responsibleList:p}}};const H=(0,m.A)(B,[["render",$],["__scopeId","data-v-122763f4"]]);var z=H,G={name:"MainPage",props:{search:{type:String,default:""}},components:{VueTableLite:q.A,MainModalPage:z},setup(e){const a=d(),t=u(),l=(0,C.KR)(!1),o=(0,C.KR)(!0),s=(0,C.KR)(null),i=(0,C.KR)(e.search),n=(0,C.KR)([]),r=(0,C.Kh)({isLoading:!1,rowClasses:e=>1==e.id?["aaa","is-id-one"]:["bbb","other"],columns:[{label:"Название",field:"equipment_name",width:"10%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Инвентарный номер",field:"inventory_number",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Мат. ответственный",field:"responsible_full_name",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Структурное подразделение",field:"division_name",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Балансовая стоимость, руб.",field:"balance_cost",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Количество",field:"quantity",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Статус оборудования",field:"equipment_status_name",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Добавил",field:"login",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Дата постановки на учет",field:"date_registration",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Дата снятия с учета",field:"date_de_registration",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Дата добавления",field:"date_start",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}},{label:"Дата последнего обновления",field:"date_update",width:"15%",sortable:!0,headerStyles:{background:"#1c274c"}}],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"asc"}}),c=(e,a,t,l)=>{r.isLoading=!0,S.getEquipmentList(t,l,i.value.length?i.value:void 0).then((e=>{e.forEach((e=>{n.value.push(e)})),r.rows=e,r.sortable.order=t,r.sortable.sort=l,r.isLoading=!1}))};c(0,10,"equipment_id","asc");const m=(a||t)&&(e=>{s.value=e,o.value=!1,l.value=!0,console.log(e)}),p=async()=>{await S.downloadFile(i.value)},b=()=>{o.value=!0,l.value=!0},v=()=>{l.value=!1,s.value={}};return{search:i,table:r,doSearch:c,rowClicked:m,isVisible:l,showModal:b,closeModal:v,downloadDocument:p,isNewEquipment:o,oldData:s,isAdmin:a,isEmployee:t}}};const Y=(0,m.A)(G,[["render",k],["__scopeId","data-v-15e25be5"]]);var Z=Y;const ee={class:"main-container"};function ae(e,a,t,l,s,i){const n=(0,o.g2)("VueTableLite"),d=(0,o.g2)("DSModalPage");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",ee,[(0,o.Lk)("button",{type:"submit",class:"add_row",title:"Добавить оборудование",onClick:a[0]||(a[0]=(...e)=>l.showModal&&l.showModal(...e))}),(0,o.bF)(n,{"is-loading":l.table.isLoading,columns:l.table.columns,rows:l.table.rows,rowClasses:l.table.rowClasses,total:l.table.totalRecordCount,"is-hide-paging":!0,"hide-default-footer":!0,sortable:l.table.sortable,onDoSearch:e.doSearch,onRowClicked:l.rowClicked,class:"table"},null,8,["is-loading","columns","rows","rowClasses","total","sortable","onDoSearch","onRowClicked"])]),l.isVisible?((0,o.uX)(),(0,o.Wv)(d,{key:0,showModal:l.isVisible,onCloseModal:l.closeModal,isNewName:l.isNewName,oldData:l.oldData},null,8,["showModal","onCloseModal","isNewName","oldData"])):(0,o.Q3)("",!0)],64)}const te={key:0,class:"modal"},le={class:"modal-content"},oe={key:0},se={key:1},ie={key:0},ne={key:1},de={key:2,for:"name1"},ue={key:3,for:"name3"},re={class:"button-block"};function ce(e,a,t,s,i,n){return t.showModal?((0,o.uX)(),(0,o.CE)("div",te,[(0,o.Lk)("div",le,["/division"===e.$route.path?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[t.isNewName?((0,o.uX)(),(0,o.CE)("h2",oe,"Добавить структурное подразделение")):((0,o.uX)(),(0,o.CE)("h2",se,"Изменить структурное подразделение"))],64)):(0,o.Q3)("",!0),"/status"===e.$route.path?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[t.isNewName?((0,o.uX)(),(0,o.CE)("h2",ie,"Добавить статус оборудования")):((0,o.uX)(),(0,o.CE)("h2",ne,"Изменить статус оборудования"))],64)):(0,o.Q3)("",!0),"/division"===e.$route.path?((0,o.uX)(),(0,o.CE)("label",de,[(0,o.bo)((0,o.Lk)("input",{id:"name1",type:"text",placeholder:"Введите название структурного подразделения","onUpdate:modelValue":a[0]||(a[0]=e=>s.divisionName=e),class:"equipment-field"},null,512),[[l.Jo,s.divisionName]])])):(0,o.Q3)("",!0),"/status"===e.$route.path?((0,o.uX)(),(0,o.CE)("label",ue,[(0,o.bo)((0,o.Lk)("input",{id:"name3",type:"text",placeholder:"Введите статус оборудования","onUpdate:modelValue":a[1]||(a[1]=e=>s.equipmentStatusName=e),class:"equipment-field"},null,512),[[l.Jo,s.equipmentStatusName]])])):(0,o.Q3)("",!0),(0,o.Lk)("div",re,[t.isNewName?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:a[2]||(a[2]=(...e)=>s.addNewName&&s.addNewName(...e))},"Добавить")):(0,o.Q3)("",!0),t.isNewName?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:a[3]||(a[3]=(...e)=>s.updateName&&s.updateName(...e))},"Изменить")),(0,o.Lk)("button",{onClick:a[4]||(a[4]=(...e)=>s.closeModal&&s.closeModal(...e))},"Закрыть")])])])):(0,o.Q3)("",!0)}var me={name:"DSTModalPage",props:{showModal:{type:Boolean,default:!1},isNewName:{type:Boolean,default:!1},oldData:{type:Object,default:null}},setup(e,{emit:a}){const t=(0,w.lq)(),l=(0,C.KR)(""),s=(0,C.KR)(""),i=(0,C.KR)(""),n=()=>{l.value="",s.value="",i.value="",a("closeModal",!1)},d=async()=>{try{"/division"===t.path&&await S.addDivision(l.value),"/type"===t.path&&await S.addEquipmentType(i.value),"/status"===t.path&&await S.addEquipmentStatus(s.value)}catch(e){console.log(e)}finally{n(),window.location.reload()}},u=async()=>{try{"/division"===t.path&&await S.updateDivision(e.oldData.division_id,l.value),"/type"===t.path&&await S.updateEquipmentType(e.oldData.equipment_type_id,i.value),"/status"===t.path&&await S.updateEquipmentStatus(e.oldData.equipment_status_id,s.value)}catch(a){console.log(a)}finally{n(),window.location.reload()}};return(0,o.sV)((()=>{e.oldData&&("/division"===t.path&&(l.value=e.oldData.division_name),"/type"===t.path&&(i.value=e.oldData.equipment_type_name),"/status"===t.path&&(s.value=e.oldData.equipment_status_name))})),{divisionName:l,equipmentTypeName:i,equipmentStatusName:s,closeModal:n,addNewName:d,updateName:u}}};const pe=(0,m.A)(me,[["render",ce],["__scopeId","data-v-4dd2f916"]]);var be=pe,ve={name:"DivisionPage",components:{VueTableLite:q.A,DSModalPage:be},setup(){const e=(0,C.KR)(!1),a=(0,C.KR)(!0),t=(0,C.KR)(""),l=(0,C.KR)([]),s=(0,C.Kh)({isLoading:!1,columns:[{label:"ID",field:"division_id",width:"3%",sortable:!1,isKey:!0,headerStyles:{background:"#1c274c"}},{label:"Название",field:"division_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}}],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"asc"}});(0,o.sV)((()=>{S.getDivisionList().then((e=>{e.forEach((e=>{l.value.push(e)})),s.rows=e,s.isLoading=!1}))}));const i=l=>{t.value=l,a.value=!1,e.value=!0,console.log(l)},n=()=>{a.value=!0,e.value=!0},d=()=>{e.value=!1,t.value=""};return{table:s,rowClicked:i,isVisible:e,showModal:n,closeModal:d,isNewName:a,oldData:t}}};const he=(0,m.A)(ve,[["render",ae],["__scopeId","data-v-3e709e46"]]);var _e=he;const we={class:"main-container"};function ge(e,a,t,l,s,i){const n=(0,o.g2)("VueTableLite"),d=(0,o.g2)("DSModalPage");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",we,[(0,o.Lk)("button",{type:"submit",class:"add_row",title:"Добавить оборудование",onClick:a[0]||(a[0]=(...e)=>l.showModal&&l.showModal(...e))}),(0,o.bF)(n,{"is-loading":l.table.isLoading,columns:l.table.columns,rows:l.table.rows,rowClasses:l.table.rowClasses,total:l.table.totalRecordCount,"is-hide-paging":!0,"hide-default-footer":!0,sortable:l.table.sortable,onDoSearch:e.doSearch,onRowClicked:l.rowClicked,class:"table"},null,8,["is-loading","columns","rows","rowClasses","total","sortable","onDoSearch","onRowClicked"])]),l.isVisible?((0,o.uX)(),(0,o.Wv)(d,{key:0,showModal:l.isVisible,onCloseModal:l.closeModal,isNewName:l.isNewName,oldData:l.oldData},null,8,["showModal","onCloseModal","isNewName","oldData"])):(0,o.Q3)("",!0)],64)}var fe={name:"StatusPage",components:{VueTableLite:q.A,DSModalPage:be},setup(){const e=(0,C.KR)(!1),a=(0,C.KR)(!0),t=(0,C.KR)(""),l=(0,C.KR)([]),s=(0,C.Kh)({isLoading:!1,columns:[{label:"ID",field:"equipment_status_id",width:"3%",sortable:!1,isKey:!0,headerStyles:{background:"#1c274c"}},{label:"Название",field:"equipment_status_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}}],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"asc"}});(0,o.sV)((()=>{S.getEquipmentStatusList().then((e=>{e.forEach((e=>{l.value.push(e)})),s.rows=e,s.isLoading=!1}))}));const i=l=>{t.value=l,a.value=!1,e.value=!0,console.log(l)},n=()=>{a.value=!0,e.value=!0},d=()=>{e.value=!1,t.value=""};return{table:s,rowClicked:i,isVisible:e,showModal:n,closeModal:d,isNewName:a,oldData:t}}};const ye=(0,m.A)(fe,[["render",ge],["__scopeId","data-v-c517f970"]]);var ke=ye;const qe={class:"main-container"};function Ce(e,a,t,l,s,i){const n=(0,o.g2)("VueTableLite");return(0,o.uX)(),(0,o.CE)("div",qe,[(0,o.bF)(n,{"is-loading":l.table.isLoading,columns:l.table.columns,rows:l.table.rows,rowClasses:l.table.rowClasses,total:l.table.totalRecordCount,"is-hide-paging":!0,"hide-default-footer":!0,sortable:l.table.sortable,class:"table"},null,8,["is-loading","columns","rows","rowClasses","total","sortable"])])}const Le={key:0,class:"modal"},Ne={class:"modal-content"},Ee={key:0},Re={key:1},De={key:2,for:"login"},Se={for:"password"},Me={for:"last_name"},Ke={for:"first_name"},Xe={for:"middle_name"},Ve={value:null,disabled:"",selected:""},Ae=["value"],Ue={value:null,disabled:"",selected:""},Pe=["value"],Qe={class:"button-block"};function Ie(e,a,t,s,i,n){return t.showModal?((0,o.uX)(),(0,o.CE)("div",Le,[(0,o.Lk)("div",Ne,[t.isNewUser?((0,o.uX)(),(0,o.CE)("h2",Ee,"Добавить пользователя")):((0,o.uX)(),(0,o.CE)("h2",Re,"Изменить данные пользователя")),t.isNewUser?((0,o.uX)(),(0,o.CE)("label",De,[(0,o.bo)((0,o.Lk)("input",{id:"login",type:"text",placeholder:"Введите логин пользователя","onUpdate:modelValue":a[0]||(a[0]=e=>s.login=e),class:"equipment-field"},null,512),[[l.Jo,s.login]])])):(0,o.Q3)("",!0),(0,o.Lk)("label",Se,[t.isNewUser?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,id:"password",type:"text",placeholder:"Введите пароль","onUpdate:modelValue":a[1]||(a[1]=e=>s.password=e),class:"equipment-field"},null,512)),[[l.Jo,s.password]]):(0,o.Q3)("",!0)]),(0,o.Lk)("label",Me,[(0,o.bo)((0,o.Lk)("input",{id:"last_name",type:"text",placeholder:"Введите фамилию пользователя","onUpdate:modelValue":a[2]||(a[2]=e=>s.lastName=e),class:"equipment-field"},null,512),[[l.Jo,s.lastName]])]),(0,o.Lk)("label",Ke,[(0,o.bo)((0,o.Lk)("input",{id:"first_name",type:"text",placeholder:"Введите имя пользователя","onUpdate:modelValue":a[3]||(a[3]=e=>s.firstName=e),class:"equipment-field"},null,512),[[l.Jo,s.firstName]])]),(0,o.Lk)("label",Xe,[(0,o.bo)((0,o.Lk)("input",{id:"middle_name",type:"text",placeholder:"Введите отчество пользователя","onUpdate:modelValue":a[4]||(a[4]=e=>s.middleName=e),class:"equipment-field"},null,512),[[l.Jo,s.middleName]])]),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>s.selectedDivision=e),id:"division",class:"equipment-field"},[(0,o.Lk)("option",Ve,(0,M.v_)(s.baseData.divisionName),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.divisionList,((e,a)=>((0,o.uX)(),(0,o.CE)("option",{value:e,key:a},(0,M.v_)(e.division_name),9,Ae)))),128))],512),[[l.u1,s.selectedDivision]]),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>s.selectedRole=e),id:"role",class:"equipment-field"},[(0,o.Lk)("option",Ue,(0,M.v_)(s.baseData.roleName),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.roleList,((e,a)=>((0,o.uX)(),(0,o.CE)("option",{value:e,key:a},(0,M.v_)(e.role_name),9,Pe)))),128))],512),[[l.u1,s.selectedRole]]),(0,o.Lk)("div",Qe,[t.isNewUser?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:a[7]||(a[7]=(...e)=>s.registration&&s.registration(...e))},"Добавить")):(0,o.Q3)("",!0),t.isNewUser?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:a[8]||(a[8]=(...e)=>s.updateUser&&s.updateUser(...e))},"Изменить")),(0,o.Lk)("button",{onClick:a[9]||(a[9]=(...e)=>s.closeModal&&s.closeModal(...e))},"Закрыть")])])])):(0,o.Q3)("",!0)}var xe={name:"UserModalPage",props:{showModal:{type:Boolean,default:!1},isNewUser:{type:Boolean,default:!1},oldData:{type:Object,default:null}},setup(e,{emit:a}){const t={divisionName:"Выберете структурное подразделение",roleName:"Выберете роль пользователя"},l=(0,C.KR)(""),s=(0,C.KR)(),i=(0,C.KR)(""),n=(0,C.KR)(""),d=(0,C.KR)(""),u=(0,C.KR)(null),r=(0,C.KR)(null),c=(0,C.KR)([]),m=(0,C.KR)([]),p=()=>{l.value="",s.value="",i.value="",n.value="",d.value="",u.value=null,r.value=null,a("closeModal",!1)},b=async()=>{const e={role_id:r.value,division_id:u.value,login:l.value,password:s.value,firstName:i.value,lastName:n.value,middleName:d.value};try{await S.registration(e.role_id.role_id,e.division_id.division_id,e.login,e.password,e.firstName,e.lastName,e.middleName)}catch(a){console.log(a)}finally{p(),window.location.reload()}},v=async()=>{const a={role_id:r.value,division_id:u.value,firstName:i.value,lastName:n.value,middleName:d.value};try{await S.updateUser(e.oldData.user_id,a.role_id.role_id,a.division_id.division_id,e.oldData.login,a.firstName,a.lastName,a.middleName)}catch(t){console.log(t)}finally{p(),window.location.reload()}};return(0,o.sV)((async()=>{await S.getDivisionList().then((e=>{e.forEach((e=>{c.value.push(e)}))})),await S.getRoleList().then((e=>{e.forEach((e=>{m.value.push(e)}))})),e.oldData&&(i.value=e.oldData.first_name,n.value=e.oldData.last_name,d.value=e.oldData.middle_name,u.value={division_id:e.oldData.division_id,division_name:e.oldData.division_name},r.value={role_id:e.oldData.role_id,role_name:e.oldData.role_name})})),{firstName:i,lastName:n,middleName:d,selectedDivision:u,selectedRole:r,baseData:t,selectedRole:r,login:l,password:s,closeModal:p,registration:b,updateUser:v,divisionList:c,roleList:m}}};const Fe=(0,m.A)(xe,[["render",Ie],["__scopeId","data-v-3b973b1a"]]);var Te=Fe,We={name:"ResponsiblesPage",components:{VueTableLite:q.A,ResponsibleModalPage:Te},setup(){const e=(0,C.KR)([]),a=(0,C.Kh)({isLoading:!1,columns:[{label:"ID",field:"responsible_id",width:"3%",sortable:!1,isKey:!0,headerStyles:{background:"#1c274c"}},{label:"Мат. ответственный",field:"equipment_responsible_full_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Подразделение",field:"division_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}}],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"asc"}});return(0,o.sV)((()=>{a.isLoading=!0,S.getEquipmentResponsibleList().then((t=>{t.forEach((a=>{e.value.push(a)})),a.rows=t,a.isLoading=!1}))})),{table:a}}};const Je=(0,m.A)(We,[["render",Ce],["__scopeId","data-v-21a473bf"]]);var Oe=Je;const je=e=>((0,o.Qi)("data-v-04c96296"),e=e(),(0,o.jt)(),e),$e={class:"login-form"},Be=je((()=>(0,o.Lk)("h2",null,"Войти",-1))),He={key:0,class:"error"},ze={key:1,class:"succsess"},Ge={class:"button-block"};function Ye(e,a,t,s,i,n){return(0,o.uX)(),(0,o.CE)("div",$e,[Be,s.error?((0,o.uX)(),(0,o.CE)("h3",He,(0,M.v_)(s.error),1)):(0,o.Q3)("",!0),s.succsess?((0,o.uX)(),(0,o.CE)("h3",ze,(0,M.v_)(s.succsess),1)):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{type:"text",placeholder:"Логин","onUpdate:modelValue":a[0]||(a[0]=e=>s.username=e)},null,512),[[l.Jo,s.username]]),(0,o.bo)((0,o.Lk)("input",{type:"password",placeholder:"Пароль","onUpdate:modelValue":a[1]||(a[1]=e=>s.password=e)},null,512),[[l.Jo,s.password]]),(0,o.Lk)("div",Ge,[(0,o.Lk)("button",{onClick:a[2]||(a[2]=(...e)=>s.login&&s.login(...e))},"Войти")])])}var Ze={name:"LoginPage",setup(){const e=(0,C.KR)(""),a=(0,C.KR)(""),t=(0,C.KR)(""),l=(0,C.KR)(""),o=(0,w.rd)(),s=()=>{l.value="",t.value="",e.value&&a.value&&S.login(e.value,a.value).then((e=>{localStorage.setItem("user_id",e.user_id),localStorage.setItem("role_id",e.role_id),o.push("/main")})).catch((e=>{t.value=e.response.data.error}))},i=()=>{l.value="",t.value="",e.value&&a.value&&S.registration(e.value,a.value).then((e=>{l.value=e.message})).catch((e=>{t.value=e.response.data.error}))};return{username:e,password:a,error:t,succsess:l,login:s,registration:i}}};const ea=(0,m.A)(Ze,[["render",Ye],["__scopeId","data-v-04c96296"]]);var aa=ea;const ta={class:"main-container"};function la(e,a,t,l,s,i){const n=(0,o.g2)("VueTableLite"),d=(0,o.g2)("UserModalPage");return(0,o.uX)(),(0,o.CE)("div",ta,[(0,o.Lk)("button",{type:"submit",class:"add_row",title:"Добавить оборудование",onClick:a[0]||(a[0]=(...e)=>l.showModal&&l.showModal(...e))}),(0,o.bF)(n,{"is-loading":l.table.isLoading,columns:l.table.columns,rows:l.table.rows,rowClasses:l.table.rowClasses,total:l.table.totalRecordCount,"is-hide-paging":!0,"hide-default-footer":!0,sortable:l.table.sortable,onDoSearch:e.doSearch,onRowClicked:l.rowClicked,class:"table"},null,8,["is-loading","columns","rows","rowClasses","total","sortable","onDoSearch","onRowClicked"]),l.isVisible?((0,o.uX)(),(0,o.Wv)(d,{key:0,showModal:l.isVisible,onCloseModal:l.closeModal,isNewUser:l.isNewUser,oldData:l.oldData},null,8,["showModal","onCloseModal","isNewUser","oldData"])):(0,o.Q3)("",!0)])}var oa={name:"UsersPage",components:{VueTableLite:q.A,UserModalPage:Te},setup(){const e=(0,C.KR)(!1),a=(0,C.KR)(!0),t=(0,C.KR)(""),l=(0,C.KR)([]),s=(0,C.Kh)({isLoading:!1,columns:[{label:"ID",field:"user_id",width:"3%",sortable:!1,isKey:!0,headerStyles:{background:"#1c274c"}},{label:"Роль пользователя",field:"role_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Логин пользователя",field:"login",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Фамилия",field:"last_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Имя",field:"first_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Отчество",field:"middle_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}},{label:"Подразделение",field:"division_name",width:"90%",sortable:!1,headerStyles:{background:"#1c274c"}}],rows:[],totalRecordCount:0,sortable:{order:"id",sort:"asc"}});(0,o.sV)((()=>{S.getUserList().then((e=>{e.forEach((e=>{l.value.push(e)})),s.rows=e,s.isLoading=!1}))}));const i=l=>{t.value=l,a.value=!1,e.value=!0,console.log(l)},n=()=>{a.value=!0,e.value=!0},d=()=>{e.value=!1,t.value=""};return{table:s,rowClicked:i,isVisible:e,showModal:n,closeModal:d,isNewUser:a,oldData:t}}};const sa=(0,m.A)(oa,[["render",la],["__scopeId","data-v-53222d3e"]]);var ia=sa;const na=[{path:"/",name:"login",component:aa},{path:"/main",name:"main",component:Z},{path:"/division",name:"division",component:_e},{path:"/responsibles",name:"responsibles",component:Oe},{path:"/users",name:"type",component:ia},{path:"/status",name:"status",component:ke},{path:"/:catchall(.*)",redirect:"/"}],da=(0,w.aE)({history:(0,w.LA)("/"),routes:na});da.beforeEach(((e,a,t)=>{const l=localStorage.getItem("user_id"),o=d(),s=u(),i=r();l||"/"===e.path?l&&"/"===e.path||!o&&(s||i)&&("/division"===e.path||"/responsibles"===e.path||"/users"===e.path||"/status"===e.path)?t("/main"):t():t("/")}));var ua=da,ra=t(6533);(0,l.Ef)(_).use(ua).use(ra).mount("#app")}},a={};function t(l){var o=a[l];if(void 0!==o)return o.exports;var s=a[l]={exports:{}};return e[l].call(s.exports,s,s.exports,t),s.exports}t.m=e,function(){var e=[];t.O=function(a,l,o,s){if(!l){var i=1/0;for(r=0;r<e.length;r++){l=e[r][0],o=e[r][1],s=e[r][2];for(var n=!0,d=0;d<l.length;d++)(!1&s||i>=s)&&Object.keys(t.O).every((function(e){return t.O[e](l[d])}))?l.splice(d--,1):(n=!1,s<i&&(i=s));if(n){e.splice(r--,1);var u=o();void 0!==u&&(a=u)}}return a}s=s||0;for(var r=e.length;r>0&&e[r-1][2]>s;r--)e[r]=e[r-1];e[r]=[l,o,s]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var l in a)t.o(a,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:a[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,l){var o,s,i=l[0],n=l[1],d=l[2],u=0;if(i.some((function(a){return 0!==e[a]}))){for(o in n)t.o(n,o)&&(t.m[o]=n[o]);if(d)var r=d(t)}for(a&&a(l);u<i.length;u++)s=i[u],t.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return t.O(r)},l=self["webpackChunkregistry_of_equipments"]=self["webpackChunkregistry_of_equipments"]||[];l.forEach(a.bind(null,0)),l.push=a.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],(function(){return t(2487)}));l=t.O(l)})();
//# sourceMappingURL=app.b37bb5fd.js.map